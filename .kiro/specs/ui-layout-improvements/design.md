# 设计文档

## 概述

界面布局改进设计旨在优化档案库房智能监测系统的用户界面，通过重新组织页面元素、调整卡片布局和优化信息展示，提升用户体验和界面的视觉效果。设计遵循现代 Web 界面设计原则，保持系统的一致性和可用性。

## 架构设计

### 整体布局架构

系统采用响应式卡片布局架构，通过 Bootstrap 网格系统实现灵活的页面布局。主要组件包括：

- **页面容器**：使用 container-fluid 提供全宽度布局
- **卡片组件**：采用 Bootstrap Card 组件作为信息展示单元
- **网格系统**：使用 row 和 col 类实现响应式布局
- **间距控制**：通过 margin 和 padding 类控制元素间距

### 布局设计原则

1. **信息层次**：重要信息优先显示，相关信息就近放置
2. **视觉平衡**：卡片高度和宽度保持协调，避免视觉不平衡
3. **空间利用**：充分利用屏幕空间，减少不必要的留白
4. **一致性**：保持统一的设计语言和交互模式

## 组件设计

### 仪表盘布局组件

**组件结构**：

- 顶部：系统状态卡片行（4 个指标卡片）
- 中部：实时环境数据卡片和最新告警信息卡片
- 底部：系统信息卡片（移动到环境数据下方）

**设计变更**：

- 移除系统信息中的系统名称和版本号字段
- 调整卡片间距，使布局更加紧凑
- 优化卡片内容排列，提高信息密度

### RFID 设备页面组件

**组件结构**：

- 左侧：RFID 读写器管理表格（增加高度）
- 右上：实时扫描状态卡片
- 右下：RFID 参数配置卡片（新位置）
- 底部：标签管理表格（下移）

**设计变更**：

- RFID 参数配置卡片移动到扫描状态下方
- 左右两列卡片高度保持一致
- 适当增加卡片高度以改善视觉效果

### 数据采集配置组件

**组件结构**：

- 左侧：采集控制卡片
- 右侧：性能监控卡片（扩展内容）

**性能监控指标**：

- CPU 使用率：实时显示处理器占用情况
- 内存使用率：显示物理内存和虚拟内存使用情况
- 磁盘使用率：显示系统盘和数据盘的空间使用情况
- 网络状态：显示网络连接数和传输速率
- 进程信息：显示活跃进程数和系统负载
- 数据库连接：显示数据库连接池状态

### 系统配置模块组件

**第一排布局**（三个卡片）：

- 基本设置卡片：系统名称、时区、语言等基础配置
- 网络设置卡片：IP 地址、端口、代理等网络配置
- 安全设置卡片：密码策略、访问控制等安全配置

**第二排布局**（两个卡片）：

- 数据管理卡片：备份、恢复、清理等数据操作
- 系统信息卡片：运行状态、资源使用等信息（移除版本号）

**表单设计**：

- 使用内联表单布局，相关字段在同一行显示
- 输入框宽度根据内容长度自适应
- 选择框和开关控件紧凑排列

## 数据模型

### 性能监控数据模型

```python
class SystemPerformance:
    cpu_usage: float          # CPU使用率 (0-100)
    memory_usage: float       # 内存使用率 (0-100)
    memory_total: int         # 总内存 (MB)
    memory_used: int          # 已用内存 (MB)
    disk_usage: float         # 磁盘使用率 (0-100)
    disk_total: int           # 总磁盘空间 (GB)
    disk_used: int            # 已用磁盘空间 (GB)
    network_connections: int  # 网络连接数
    network_rx_rate: float    # 网络接收速率 (KB/s)
    network_tx_rate: float    # 网络发送速率 (KB/s)
    process_count: int        # 进程数量
    load_average: float       # 系统负载
    db_connections: int       # 数据库连接数
    timestamp: datetime       # 采集时间
```

### 配置数据模型

```python
class UILayoutConfig:
    dashboard_layout: dict    # 仪表盘布局配置
    rfid_layout: dict        # RFID页面布局配置
    collection_layout: dict  # 数据采集页面布局配置
    settings_layout: dict    # 系统配置页面布局配置
    card_heights: dict       # 卡片高度配置
    spacing_config: dict     # 间距配置
    responsive_breakpoints: dict  # 响应式断点配置
```

## 接口设计

### 性能监控 API

**获取系统性能数据**

```
GET /api/system/performance
Response: {
    "cpu_usage": 45.2,
    "memory_usage": 68.5,
    "memory_total": 8192,
    "memory_used": 5611,
    "disk_usage": 72.3,
    "disk_total": 256,
    "disk_used": 185,
    "network_connections": 127,
    "network_rx_rate": 1024.5,
    "network_tx_rate": 512.3,
    "process_count": 156,
    "load_average": 1.25,
    "db_connections": 5,
    "timestamp": "2024-01-15T10:30:00Z"
}
```

### 布局配置 API

**获取布局配置**

```
GET /api/ui/layout-config
Response: {
    "dashboard_layout": {
        "system_info_position": "bottom",
        "card_spacing": "mb-4"
    },
    "rfid_layout": {
        "config_card_position": "right-bottom",
        "card_height": "400px"
    }
}
```

**更新布局配置**

```
POST /api/ui/layout-config
Request: {
    "dashboard_layout": {...},
    "rfid_layout": {...}
}
```

## 错误处理

### 性能监控错误处理

1. **数据采集失败**：显示"数据获取失败"提示，使用缓存数据
2. **指标计算错误**：显示"--"占位符，记录错误日志
3. **网络连接异常**：显示离线状态，定时重试连接

### 布局渲染错误处理

1. **卡片加载失败**：显示错误占位符，保持页面结构
2. **响应式适配问题**：回退到默认布局，确保基本可用性
3. **配置加载失败**：使用默认配置，记录错误信息

## 测试策略

### 布局测试

1. **视觉回归测试**：确保布局调整后界面显示正确
2. **响应式测试**：验证不同屏幕尺寸下的显示效果
3. **交互测试**：确保所有按钮和链接功能正常

### 性能监控测试

1. **数据准确性测试**：验证性能指标的准确性
2. **实时更新测试**：确保数据能够实时刷新
3. **异常处理测试**：验证错误情况下的处理逻辑

### 兼容性测试

1. **浏览器兼容性**：测试主流浏览器的显示效果
2. **设备兼容性**：验证不同设备上的用户体验
3. **分辨率适配**：确保各种分辨率下的正常显示

## 实施计划

### 第一阶段：仪表盘优化

- 调整系统信息卡片位置
- 移除不必要的字段
- 优化卡片间距

### 第二阶段：RFID 页面重排

- 重新排列卡片位置
- 调整卡片高度
- 优化表格布局

### 第三阶段：数据采集配置

- 扩展性能监控指标
- 实现新的性能数据采集
- 优化卡片布局

### 第四阶段：系统配置改进

- 重新设计配置表单
- 实现紧凑布局
- 优化用户交互

每个阶段完成后进行测试验证，确保功能正常且用户体验良好。
