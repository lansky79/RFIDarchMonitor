<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>简单测试</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container mt-4">
      <h1>系统测试</h1>
      <div id="status" class="alert alert-info">正在测试...</div>
      <div id="results"></div>
    </div>

    <script src="frontend/js/api.js"></script>
    <script>
      const statusDiv = document.getElementById("status");
      const resultsDiv = document.getElementById("results");

      async function runTests() {
        try {
          // 测试1: 检查ApiClient
          if (typeof window.api === "undefined") {
            throw new Error("window.api未定义");
          }

          statusDiv.innerHTML =
            '<div class="alert alert-success">✓ API客户端加载成功</div>';

          // 测试2: 调用健康检查API
          const health = await window.api.getSystemHealth();
          resultsDiv.innerHTML +=
            '<div class="alert alert-success">✓ 健康检查API调用成功: ' +
            JSON.stringify(health) +
            "</div>";

          // 测试3: 调用系统信息API
          const info = await window.api.getSystemInfo();
          resultsDiv.innerHTML +=
            '<div class="alert alert-success">✓ 系统信息API调用成功</div>';

          statusDiv.innerHTML =
            '<div class="alert alert-success">所有测试通过！</div>';
        } catch (error) {
          statusDiv.innerHTML =
            '<div class="alert alert-danger">测试失败: ' +
            error.message +
            "</div>";
          console.error("测试错误:", error);
        }
      }

      // 页面加载后运行测试
      document.addEventListener("DOMContentLoaded", runTests);
    </script>
  </body>
</html>
